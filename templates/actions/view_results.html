{% extends "base.html" %}
{% block content %}
  <div class="container">
    
    {% if message %}
      {{ message }}
    {% endif %}

    {# ONLY ONE OBJECT #}
    {% if result is defined %}
      <div class="row">
        <div class="col-md-9">
          {% for r in result['items'] %}
            {% if r['snippet'] %}
              <h3 id="title_data"> {{ result['items'][0]['snippet']['title'] }} </h3>
            {% endif %}
          {% endfor %}
        </div>
        <div class="col-md-3">
          {% for r in result['items'] %}
            {% if r['snippet'] %}
              <h4> {{ result['items'][0]['snippet']['publishedAt'] }} </h4>
            {% endif %}
          {% endfor %}
          <button id="json" class="btn btn-primary">JSON</button>
          <!-- <button id="csv" class="btn btn-primary">CSV</button> -->
        </div>
      </div>

      <hr/>

      <div class="row">
        <div class="col-md-7">
          <h5>JSON response from youtube Data API</h5>
          <pre id="code">{{ string }}</pre>
        </div>
        
        <div class="col-md-5">
          {% for r in result['items'] %}
            {% if r['player'] %}
              {{ r['player']['embedHtml']|safe }}
              {% elif r['snippet'] %}
              <img src="{{ r['snippet']['thumbnails']['medium']['url']|safe }}">
            {% endif %}
          {% endfor %}
          <hr/>
          <h5>Human readable</h5>
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingOne">
                <h4 class="panel-title">
                <a class="collapsed" role="button" data-toggle="collapse"  href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                  Item
                </a>
                </h4>
              </div>
              <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                <div class="panel-body">
                  {% for dict_item in result['items'] %}
                    <ul>
                      {% for key, value in dict_item.items() %}
                        <li><strong>{{ key }} :</strong></li>
                        {% if value is mapping %}
                          {% for subkey, subvalue in value.items()  %}
                            <ul>
                              <li><strong>{{ subkey }}</strong> : {{ subvalue }}</li>
                            </ul>
                          {% endfor %}
                        {% else %}
                          {{ value }}
                        {% endif %}
                      {% endfor %}
                    </ul>
                  {% endfor %}
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingTwo">
                <h4 class="panel-title">
                <a class="collapsed" role="button" data-toggle="collapse"  href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                  Meta info
                </a>
                </h4>
              </div>
              <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                <div class="panel-body">
                  <ul>
                    <li><strong>etag</strong> : {{ result['etag']|safe }}</li>
                    <li><strong>pageInfo</strong> : {{ result['pageInfo']|safe }}</li>
                    <li><strong>kind</strong> : {{ result['kind']|safe }}</li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingThree">
                <h4 class="panel-title">
                <a class="collapsed" role="button" data-toggle="collapse"  href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                  Comments
                </a>
                </h4>
              </div>
              <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                <div class="panel-body">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    


    {# OR LIST OF OBJECTS #}
    {% elif results is defined %}
      <div class="row">
        <ul class="pagination">
          {% if result is defined %}
            {% elif counter > 0 %}
            <!-- <li><a href="?prevPageToken={{ prev }}"> Prev </a></li> -->
          {% endif %}
          <li class="active"><a href="#">{{ counter }}</a></li>
          <li><a href="?nextPageToken={{ results['nextPageToken'] }}">Next</a></li>
          <li><a href="process_results"> Go to end & download </a></li>
        </ul>
      </div>

      <div class="row">
        <div class="col-md-7">
          <pre>{{ string }}</pre>
        </div>

        <div class="col-md-5">
          <h4>first level - not items</h4>
          <ul>
            <li>{{ results['nextPageToken']|safe }}</li>
            <li>{{ results['regionCode']|safe }}</li>
            <li>{{ results['pageInfo']|safe }}</li>
            <li>{{ results['etag']|safe }}</li>
            <li>{{ results['kind']|safe }}</li>
          </ul>
          <h4>items</h4> {% for dict_item in results['items'] %}
            <ul>
              {% for key, value in dict_item.items() %} {% if key == 'id'%}
                <li> {{ key|upper }} : {{ value['videoId']|safe }}</li>
              {% endif %} {% if key == 'snippet'%}
              <li> TITLE : {{ value['title']|safe }}</li>
              <li> DESCRIPTION : {{ value['description']|safe }}</li>
              <li> CHANNEL_TITLE : {{ value['channelTitle']|safe }}</li>
              <li> CHANNEL_ID : {{ value['channelId']|safe }}</li>
              <li> PUBLISHED_AT : {{ value['publishedAt']|safe }}</li>
              <p>
                {# <a href="https://www.youtube.com/watch?v={{ dict_item['id']['videoId']|safe }}">
                  <img src="{{ value['thumbnails']['default']['url']|safe }}">
                </a> #}
              </p>
            {% endif %} {% endfor %}
          </ul>
        {% endfor %}
        </div>
      </div>
    {% endif %}


  </div>
{% endblock %}